{"version":3,"file":"apiService.DFT83caO.js","sources":["../../../src/services/apiService.ts"],"sourcesContent":["/**\n * Servicio API centralizado para Masclet Imperi\n * ==========================================\n * \n * Esta versi√≥n ha sido actualizada para usar la configuraci√≥n centralizada\n * de API a trav√©s del adaptador apiConfigAdapter.ts\n */\n\nimport axios from 'axios';\nimport { \n  API_BASE_URL,\n  API_TIMEOUT,\n  API_DEFAULT_HEADERS,\n  environment,\n  isProduction,\n  isLocal,\n  TOKEN_NAME\n} from './apiConfigAdapter';\n\n// Variables para mantener compatibilidad con c√≥digo existente\nlet ENVIRONMENT: string = environment;\nlet USE_MOCK_DATA: boolean = false;\n\n// Imprimir informaci√≥n de diagn√≥stico\nconsole.log(`[ApiService] Entorno: ${ENVIRONMENT}`);\nconsole.log(`[ApiService] API configurada para conectarse a: ${API_BASE_URL}`);\n\nif (isProduction) {\n  console.log('[ApiService] Ejecutando en modo PRODUCCI√ìN');\n} else {\n  // Modo local (incluye localhost, 127.0.0.1, redes internas, etc.)\n  console.log('[ApiService] Ejecutando en modo LOCAL');\n}\n\n// Credenciales fijas para desarrollo: admin/admin123\n// Estas son las credenciales indicadas en los requisitos\n\n// Mantener una copia local de la URL base para posibles modificaciones\nlet apiBaseUrl = API_BASE_URL;\n\n// Crear instancia de axios con configuraci√≥n base centralizada\nconst api = axios.create({\n  baseURL: apiBaseUrl,\n  timeout: API_TIMEOUT,\n  headers: API_DEFAULT_HEADERS\n});\n\n// GESTI√ìN UNIVERSAL DE PETICIONES API\napi.interceptors.request.use(\n  (config) => {\n    const endpoint = config.url || '';\n    \n    // Debug para todas las peticiones\n    // console.log(`[API] Procesando solicitud: ${endpoint}`);\n    \n    // Evitar duplicaci√≥n de prefijos /api/v1\n    const finalUrl = `${config.baseURL || ''}${config.url || ''}`;\n    if (finalUrl.includes('/api/v1/api/v1/')) {\n      console.log(`[API] Corrigiendo URL duplicada: ${finalUrl}`);\n      const fixedUrl = finalUrl.replace('/api/v1/api/v1/', '/api/v1/');\n      const baseUrlPart = config.baseURL || '';\n      config.url = fixedUrl.replace(baseUrlPart, '');\n      console.log(`[API] URL corregida: ${baseUrlPart}${config.url}`);\n    }\n    \n    // Asegurar encabezados AUTH\n    if (typeof localStorage !== 'undefined' && localStorage.getItem(TOKEN_NAME)) {\n      config.headers.Authorization = `Bearer ${localStorage.getItem(TOKEN_NAME)}`;\n    }\n    \n    // NO activamos withCredentials en ning√∫n entorno para evitar problemas CORS\n    // Las cookies no son necesarias para nuestro esquema de autenticaci√≥n JWT\n    config.withCredentials = false;\n    \n    // Si estamos en producci√≥n, configuraci√≥n adicional\n    if (isProduction) {\n      // En producci√≥n, asegurar que todas las peticiones son seguras\n      if (config.url && config.url.startsWith('http:')) {\n        config.url = config.url.replace('http:', 'https:');\n      }\n      \n      // Asegurar que baseURL es HTTPS en producci√≥n\n      if (config.baseURL && config.baseURL.startsWith('http:')) {\n        config.baseURL = config.baseURL.replace('http:', 'https:');\n      }\n      \n      console.log(`[PROD] URL final: ${config.baseURL}${config.url}`);\n    }\n    \n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Interceptor para a√±adir credenciales a todas las peticiones\napi.interceptors.request.use(\n  (config) => {\n    // Intentar usar el token JWT del localStorage\n    if (typeof window !== 'undefined' && window.localStorage) {\n      try {\n        const token = localStorage.getItem(TOKEN_NAME);\n        if (token) {\n          config.headers['Authorization'] = `Bearer ${token}`;\n          console.log('Usando token JWT para autenticaci√≥n');\n        } else {\n          console.warn('No se encontr√≥ token en localStorage');\n          // Opcional: redirigir a login si no hay token\n        }\n      } catch (e) {\n        console.warn('No se pudo acceder a localStorage:', e);\n      }\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Funci√≥n para configurar la API\nexport function configureApi(baseUrl: string, useMockData: boolean = false) {\n  apiBaseUrl = baseUrl; // Usar variable local en lugar de la importada\n  USE_MOCK_DATA = useMockData;\n  api.defaults.baseURL = baseUrl;\n  \n  console.log(`API configurada con URL base: ${baseUrl}`);\n  console.log(`Uso de datos simulados: ${useMockData ? 'S√ç' : 'NO'}`);\n}\n\n// Funci√≥n para realizar peticiones GET\nexport async function get<T = any>(endpoint: string): Promise<T> {\n  try {\n    // Normalizar endpoint asegurando que empiece con /\n    const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    \n    // IMPORTANTE: A√±adir prefijo /api/v1 si no est√° presente y no hay ya un prefijo en la URL base\n    let apiEndpoint = normalizedEndpoint;\n    // Comprobar si ya hay un prefijo en la URL base (config.baseURL) o si ya hay un prefijo en el endpoint\n    const baseUrlHasPrefix = apiBaseUrl.includes('/api/v1');\n    if (!apiEndpoint.startsWith('/api/v1') && !baseUrlHasPrefix) {\n      apiEndpoint = `/api/v1${normalizedEndpoint}`;\n      console.log(`A√±adiendo prefijo a endpoint: ${normalizedEndpoint} -> ${apiEndpoint}`);\n    }\n    \n    // Quitar / al final si el endpoint lo tiene y no contiene query params\n    // El backend est√° redirigiendo los endpoints con / al final a los que no lo tienen\n    const finalEndpoint = (!apiEndpoint.includes('?') && apiEndpoint.endsWith('/')) \n      ? apiEndpoint.slice(0, -1) \n      : apiEndpoint;\n    \n    // IMPORTANTE: En producci√≥n, solo imprimir la ruta relativa\n    if (isProduction) {\n      // console.log(`Realizando petici√≥n GET a: ${finalEndpoint}`);\n    } else {\n      console.log(`Realizando petici√≥n GET a: ${finalEndpoint}`);\n    }\n    \n    const response = await api.get<T>(finalEndpoint);\n    \n    // Registrar informaci√≥n detallada de la respuesta para depuraci√≥n\n    // console.log(`‚úÖ Respuesta recibida de ${finalEndpoint}:`, {\n    //   status: response.status,\n    //   statusText: response.statusText,\n    //   dataType: typeof response.data,\n    //   isNull: response.data === null,\n    //   isUndefined: response.data === undefined,\n    //   dataLength: response.data && typeof response.data === 'object' ? Object.keys(response.data).length : 'N/A'\n    // });\n    \n    // Si la data es undefined o null, registrar warning y devolver objeto vac√≠o\n    if (response.data === undefined || response.data === null) {\n      // console.warn(`‚ö†Ô∏è Datos recibidos vac√≠os en ${finalEndpoint}`);\n      \n      // Devolver objeto vac√≠o del tipo esperado para evitar errores\n      if (Array.isArray(response.data)) {\n        return [] as unknown as T;\n      } else {\n        return {} as T;\n      }\n    }\n    \n    return response.data;\n  } catch (error) {\n    // Mejorar el log de errores para facilitar la depuraci√≥n\n    if (axios.isAxiosError(error)) {\n      // Solo mantenemos un log de error b√°sico para diagn√≥stico\n      console.error(`‚ùå Error en petici√≥n GET a ${endpoint}: ${error.message} (${error.response?.status || 'sin status'})`);\n    } else {\n      console.error(`‚ùå Error no relacionado con Axios en ${endpoint}: ${error}`);\n    }\n    \n    // Mecanismo de reintento para errores 404\n    if (axios.isAxiosError(error) && error.response?.status === 404) {\n      // Obtener la URL original que fall√≥\n      const originalUrl = error.config?.url || '';\n      const absoluteUrl = error.config?.baseURL ? `${error.config.baseURL}${originalUrl}` : originalUrl;\n      \n      // Registrar el fallo para diagn√≥stico\n      // console.warn(`‚ö†Ô∏è Error 404 en: ${absoluteUrl}`);\n      \n      // En desarrollo local, simplemente registramos el error y dejamos que falle normalmente\n      if (!isProduction) {\n        // console.warn(`Entorno de desarrollo: sin reintentos autom√°ticos`);\n      } else {\n        // En producci√≥n, intentamos estrategias de recuperaci√≥n\n        \n        // Estrategia 1: Convertir URL absoluta a relativa\n        if (absoluteUrl.includes('://')) {\n          try {\n            // Extraer solo el path para hacer una petici√≥n relativa\n            const urlObj = new URL(absoluteUrl);\n            const relativePath = urlObj.pathname + urlObj.search;\n            // console.log(`üîß Detectada URL absoluta, reintentando con ruta relativa: ${relativePath}`);\n            \n            // Hacer una petici√≥n completamente relativa\n            try {\n              // Configurar manualmente para ignorar cualquier baseURL\n              const retryResponse = await axios.get<T>(relativePath, {\n                baseURL: '',\n                headers: error.config?.headers\n              });\n              // console.log(`‚úÖ √âxito con la ruta relativa!`);\n              return retryResponse.data;\n            } catch (retryError) {\n              // console.error(`üí• Fall√≥ el intento con ruta relativa: ${relativePath}`);\n            }\n          } catch (e) {\n            // console.warn(`No se pudo procesar la URL para reintento: ${absoluteUrl}`);\n          }\n        }\n        \n        // Estrategia 2: Corregir URLs mal formadas\n        if (originalUrl.includes('//') || originalUrl.includes('api/api') || \n            (originalUrl.includes('/api/v1') && endpoint.includes('/api/v1'))) {\n          \n          // console.log(`üîß Detectada URL mal formada, intentando corregir...`);\n          \n          // Corregir problemas comunes en las URLs\n          let correctedUrl = endpoint.replace(/api\\/api/g, 'api');\n          correctedUrl = correctedUrl.replace(/\\/api\\/v1\\/api\\/v1/g, '/api/v1');\n          correctedUrl = correctedUrl.replace(/\\/\\/api\\/v1/g, '/api/v1');\n          \n          // Si la URL se corrige, intentar nuevamente\n          if (correctedUrl !== endpoint) {\n            // console.log(`üî® Reintentando con URL corregida: ${correctedUrl}`);\n            try {\n              const retryResponse = await api.get<T>(correctedUrl);\n              // console.log(`‚úÖ √âxito con URL corregida!`);\n              return retryResponse.data;\n            } catch (retryError) {\n              // console.error(`üí• Tambi√©n fall√≥ el reintento con URL corregida`);            \n            }\n          }\n        }\n        \n        // Estrategia 3: √öltimo intento con ruta absoluta desde ra√≠z\n        if (error.config?.baseURL) {\n          try {\n            let finalAttemptUrl = originalUrl;\n            if (!finalAttemptUrl.startsWith('/api')) {\n              finalAttemptUrl = `/api/v1/${finalAttemptUrl.startsWith('/') ? finalAttemptUrl.substring(1) : finalAttemptUrl}`;\n            }\n            \n            // console.log(`ü§ñ √öltimo intento con ruta absoluta: ${finalAttemptUrl}`);\n            const lastResponse = await axios.get<T>(finalAttemptUrl, {\n              baseURL: ''\n            });\n            // console.log(`‚úÖ √âxito en el √∫ltimo intento!`);\n            return lastResponse.data;\n          } catch (lastError) {\n            // console.error(`üí• Fall√≥ el √∫ltimo intento de recuperaci√≥n`); \n          }\n        }\n      }\n      \n      // Si llegamos aqu√≠, el reintento fall√≥ o no se intent√≥, devolver array vac√≠o para endpoints de lista\n      if (endpoint.includes('list') || \n          endpoint.includes('all') || \n          endpoint.includes('explotacions') || \n          endpoint.includes('animales')) {\n        // console.warn(`Devolviendo array vac√≠o para ${endpoint} debido a 404`);\n        return [] as unknown as T;\n      }\n    }\n    \n    // Devolver objeto vac√≠o para evitar que la UI se rompa\n    return {} as T;\n  }\n}\n\n// Funci√≥n para realizar peticiones POST\nexport async function post<T = any>(endpoint: string, data: any): Promise<T> {\n  try {\n    const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    const response = await api.post<T>(normalizedEndpoint, data);\n    return response.data;\n  } catch (error) {\n    console.error(`Error en petici√≥n POST a ${endpoint}:`, error);\n    throw error;\n  }\n}\n\n// Funci√≥n para realizar peticiones PUT\nexport async function put<T = any>(endpoint: string, data: any): Promise<T> {\n  try {\n    const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    const response = await api.put<T>(normalizedEndpoint, data);\n    return response.data;\n  } catch (error) {\n    console.error(`Error en petici√≥n PUT a ${endpoint}:`, error);\n    throw error;\n  }\n}\n\n// Funci√≥n para realizar peticiones PATCH\nexport async function patch<T = any>(endpoint: string, data: any): Promise<T> {\n  try {\n    // Normalizar endpoint\n    const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    console.log(`Realizando petici√≥n PATCH a ${apiBaseUrl}${normalizedEndpoint}`);\n    console.log('Datos enviados:', data);\n    \n    // Realizar petici√≥n utilizando URL base local\n    const response = await api.patch<T>(normalizedEndpoint, data);\n    return response.data;\n  } catch (error) {\n    console.error(`Error en petici√≥n PATCH a ${endpoint}:`, error);\n    throw error;\n  }\n}\n\n// Funci√≥n para realizar peticiones DELETE\nexport async function del<T = any>(endpoint: string): Promise<T> {\n  try {\n    const normalizedEndpoint = endpoint.startsWith('/') ? endpoint : `/${endpoint}`;\n    const response = await api.delete<T>(normalizedEndpoint);\n    return response.data;\n  } catch (error) {\n    console.error(`Error en petici√≥n DELETE a ${endpoint}:`, error);\n    throw error;\n  }\n}\n\n// Funci√≥n para verificar si el usuario est√° autenticado\nexport async function isAuthenticated(): Promise<boolean> {\n  try {\n    // Verificar si hay un token en localStorage\n    if (typeof window !== 'undefined' && window.localStorage) {\n      const token = localStorage.getItem('token');\n      if (!token) return false;\n      \n      // Opcionalmente, verificar la validez del token con el backend\n      // await get('/auth/verify');\n      return true;\n    }\n    return false;\n  } catch (error) {\n    console.error('Error al verificar autenticaci√≥n:', error);\n    return false;\n  }\n}\n\n// Funci√≥n para obtener informaci√≥n del usuario actual\nexport async function getUserInfo() {\n  try {\n    if (await isAuthenticated()) {\n      return await get('/users/me');\n    }\n    return null;\n  } catch (error) {\n    console.error('Error al obtener informaci√≥n del usuario:', error);\n    return null;\n  }\n}\n\n// Funci√≥n para iniciar sesi√≥n usando el formato OAuth2 requerido\nexport async function login(username: string, password: string) {\n  try {\n    // Crear los datos en formato application/x-www-form-urlencoded que espera OAuth2\n    const formData = new URLSearchParams();\n    formData.append('username', username);\n    formData.append('password', password);\n    formData.append('grant_type', 'password');\n    \n    // Ruta de login directa sin concatenar baseURL para evitar problemas\n    const loginEndpoint = '/auth/login';\n    \n    // Determinar qu√© URL usar para el login\n    let loginUrl = loginEndpoint;\n    let useBaseUrlOverride = false;\n    let baseUrlOverride = '';\n    \n    if (typeof window !== 'undefined') {\n      const hostname = window.location.hostname;\n      const isLocalNetwork = \n        hostname === 'localhost' || \n        hostname === '127.0.0.1' ||\n        /^192\\.168\\./.test(hostname) ||\n        /^10\\./.test(hostname) ||\n        /^172\\.(1[6-9]|2[0-9]|3[0-1])/.test(hostname);\n      \n      if (isLocalNetwork) {\n        // Para redes locales usando IP, forzar conexi√≥n a localhost:8000\n        useBaseUrlOverride = true;\n        baseUrlOverride = 'http://127.0.0.1:8000/api/v1';\n        loginUrl = '/auth/login'; // Sin api/v1 ya que est√° en baseUrlOverride\n        console.log(`Realizando login a: ${baseUrlOverride}${loginUrl}`);\n      } else if (isProduction) {\n        console.log(`Realizando login a: /api/v1${loginEndpoint}`);\n      } else {\n        console.log(`Realizando login a: ${api.defaults.baseURL}${loginEndpoint}`);\n      }\n    } else {\n      console.log(`Realizando login a: ${api.defaults.baseURL}${loginEndpoint}`);\n    }\n    \n    // Realizar la solicitud con el formato correcto\n    let response;\n    if (useBaseUrlOverride) {\n      // Crear una instancia de axios temporal para esta petici√≥n espec√≠fica\n      const tempAxios = axios.create({\n        baseURL: baseUrlOverride,\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      });\n      response = await tempAxios.post(loginUrl, formData);\n    } else {\n      // Usar configuraci√≥n est√°ndar\n      response = await api.post(loginEndpoint, formData, {\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      });\n    }\n    \n    // Guardar el token en localStorage\n    if (typeof window !== 'undefined' && window.localStorage && response.data.access_token) {\n      localStorage.setItem('token', response.data.access_token);\n      console.log('Token guardado correctamente');\n    }\n    \n    return response;\n  } catch (error) {\n    console.error('Error al iniciar sesi√≥n:', error);\n    throw error;\n  }\n}\n\n// Funci√≥n para obtener la URL base de la API (para depuraci√≥n)\nexport function getBaseUrl(): string {\n  return apiBaseUrl;\n};\n\nexport default {\n  get,\n  post,\n  put,\n  patch,\n  del,\n  isAuthenticated,\n  getUserInfo,\n  login,\n  configureApi,\n  getBaseUrl\n};\n"],"names":["ENVIRONMENT","environment","API_BASE_URL","isProduction","apiBaseUrl","api","axios","API_TIMEOUT","API_DEFAULT_HEADERS","config","finalUrl","fixedUrl","baseUrlPart","TOKEN_NAME","error","token","e","configureApi","baseUrl","useMockData","get","endpoint","normalizedEndpoint","apiEndpoint","baseUrlHasPrefix","finalEndpoint","response","originalUrl","absoluteUrl","urlObj","relativePath","correctedUrl","finalAttemptUrl","post","data","put","patch","del","isAuthenticated","getUserInfo","login","username","password","formData","loginEndpoint","loginUrl","useBaseUrlOverride","baseUrlOverride","hostname","getBaseUrl","apiService"],"mappings":"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"}