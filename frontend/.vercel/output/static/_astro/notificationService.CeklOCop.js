import{c as o}from"./vendor.DPE1g--N.js";const l={ENABLE_NOTIFICATIONS:!1};class c{isEnabled=l.ENABLE_NOTIFICATIONS;t(){return this.isEnabled&&console.warn("DEPRECATED: llamada a método t() en notificationService"),!1}baseUrl="http://localhost:8000/api/v1/notifications";pollingInterval=null;async getNotifications(t=!1,e=10,a=0){if(!this.isEnabled)return{items:[],total:0,unread_count:0,has_more:!1};try{const r=new URLSearchParams;r.append("unread_only",t.toString()),r.append("limit",e.toString()),r.append("skip",a.toString());const i=localStorage.getItem("token"),s={};i&&(s.Authorization=`Bearer ${i}`);const n=await o.get(`${this.baseUrl}?${r.toString()}`,{headers:s});return{items:n.data.items||[],total:n.data.total||0,unread_count:n.data.unread_count||0,has_more:n.data.has_more||!1}}catch(r){return console.error("Error al obtener notificaciones:",r),{items:[],total:0,unread_count:0,has_more:!1}}}async markAsRead(t){if(!this.isEnabled)return!0;try{const e=localStorage.getItem("token"),a={};return e&&(a.Authorization=`Bearer ${e}`),await o.post(`${this.baseUrl}/mark-read/${t}`,{},{headers:a}),!0}catch(e){return console.error(`Error al marcar notificación ${t} como leída:`,e),!1}}async markAllAsRead(){if(!this.isEnabled)return!0;try{const t=localStorage.getItem("token"),e={};return t&&(e.Authorization=`Bearer ${t}`),await o.post(`${this.baseUrl}/mark-all-read`,{},{headers:e}),!0}catch(t){return console.error("Error al marcar todas las notificaciones como leídas:",t),!1}}async deleteNotification(t){if(!this.isEnabled)return!0;try{const e=localStorage.getItem("token"),a={};return e&&(a.Authorization=`Bearer ${e}`),await o.delete(`${this.baseUrl}/${t}`,{headers:a}),!0}catch(e){return console.error(`Error al eliminar notificación ${t}:`,e),!1}}async deleteAllNotifications(){if(!this.isEnabled)return!0;try{const t=localStorage.getItem("token"),e={};return t&&(e.Authorization=`Bearer ${t}`),await o.delete(this.baseUrl,{headers:e}),!0}catch(t){return console.error("Error al eliminar todas las notificaciones:",t),!1}}startPolling(t,e=3e4){if(!this.isEnabled)return console.info("Servicio de notificaciones deshabilitado: No se inicia polling"),0;this.getNotifications().then(r=>{t(r.items)}).catch(r=>{console.error("Error al obtener notificaciones:",r)});const a=window.setInterval(()=>{this.getNotifications().then(r=>{t(r.items)}).catch(r=>{console.error("Error al obtener notificaciones:",r)})},e);return this.pollingInterval=a,a}stopPolling(){this.isEnabled&&this.pollingInterval!==null&&(window.clearInterval(this.pollingInterval),this.pollingInterval=null)}async createTestNotification(){if(!this.isEnabled)return!0;try{const t=localStorage.getItem("token"),e={};return t&&(e.Authorization=`Bearer ${t}`),await o.post(`${this.baseUrl}/test`,{},{headers:e}),!0}catch(t){return console.error("Error al crear notificación de prueba:",t),!1}}}const d=new c;export{d as n};
