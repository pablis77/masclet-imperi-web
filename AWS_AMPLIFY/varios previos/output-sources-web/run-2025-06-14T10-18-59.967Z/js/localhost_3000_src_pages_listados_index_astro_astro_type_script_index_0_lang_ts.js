import * as listadosService from "/src/services/listados-service.ts";
import { getCurrentLanguage, t } from "/src/i18n/config.ts";
function updateAllTranslations() {
  try {
    const currentLang = getCurrentLanguage();
    console.log("Listados: Actualizando traducciones al idioma:", currentLang);
    document.querySelectorAll("[data-i18n-key]").forEach((el) => {
      const key = el.getAttribute("data-i18n-key");
      if (key) {
        const translation = t(key, currentLang);
        if (translation !== key) {
          el.textContent = translation;
          console.log(`Traducido '${key}' a '${translation}'`);
        }
      }
    });
    const pageTitle = document.getElementById("page-title");
    if (pageTitle) {
      pageTitle.textContent = t("listings.title", currentLang);
    }
  } catch (error) {
    console.error("Error al actualizar traducciones:", error);
  }
}
document.addEventListener("DOMContentLoaded", () => {
  updateAllTranslations();
  window.addEventListener("storage", function(e) {
    if (e.key === "userLanguage") {
      updateAllTranslations();
    }
  });
});
document.addEventListener("DOMContentLoaded", async () => {
  const listadosContainer = document.getElementById("listados-container");
  const listadosTable = document.getElementById("listados-table");
  const listadosBody = document.getElementById("listados-body");
  const loadingMessage = document.getElementById("loading-message");
  const errorMessage = document.getElementById("error-message");
  const emptyMessage = document.getElementById("empty-message");
  const token = localStorage.getItem("token");
  if (!token) {
    window.location.href = "/login";
    return;
  }
  const currentLang = localStorage.getItem("userLanguage") || "es";
  const translations = {
    es: {
      view: "Ver",
      edit: "Editar",
      delete: "Eliminar",
      "export": "Exportar",
      confirmDelete: "¿Estás seguro de que quieres eliminar este listado?",
      error: "Error al cargar los listados.",
      dateFormat: {
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
      }
    },
    ca: {
      view: "Veure",
      edit: "Editar",
      delete: "Eliminar",
      "export": "Exportar",
      confirmDelete: "Estàs segur que vols eliminar aquest llistat?",
      error: "Error al carregar els llistats.",
      dateFormat: {
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
      }
    }
  };
  const t2 = (key) => {
    return translations[currentLang]?.[key] || key;
  };
  try {
    const listados = await listadosService.getListados();
    loadingMessage.classList.add("hidden");
    if (listados.length === 0) {
      emptyMessage.classList.remove("hidden");
    } else {
      listadosTable.classList.remove("hidden");
      listadosBody.innerHTML = "";
      const dateFormatter = new Intl.DateTimeFormat(
        currentLang === "ca" ? "ca-ES" : "es-ES",
        t2("dateFormat")
      );
      listados.forEach((listado) => {
        const row = document.createElement("tr");
        const createdDate = new Date(listado.created_at);
        const formattedDate = dateFormatter.format(createdDate);
        row.innerHTML = `
            <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 dark:text-gray-100 sm:pl-6">
              ${listado.nombre}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400">
              ${listado.categoria || "-"}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400">
              ${listado.animales_count || 0}
            </td>
            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400">
              ${formattedDate}
            </td>
            <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
              <div class="flex justify-end space-x-2">
                <a href="/listados/${listado.id}" class="inline-flex items-center px-2 py-1 bg-primary text-white rounded hover:bg-primary/80">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                  </svg>
                  ${t2("view")}
                </a>
                <a href="/listados/editar/${listado.id}" class="inline-flex items-center px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                  ${t2("edit")}
                </a>
                <button 
                  data-listado-id="${listado.id}" 
                  class="delete-button inline-flex items-center px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                  ${t2("delete")}
                </button>
                <!-- Enlace de exportar eliminado -->
              </div>
            </td>
          `;
        listadosBody.appendChild(row);
      });
      document.querySelectorAll(".delete-button").forEach((button) => {
        button.addEventListener("click", async (e) => {
          const listadoId = e.target.dataset.listadoId;
          if (confirm(t2("confirmDelete"))) {
            try {
              await listadosService.deleteListado(listadoId);
              window.location.reload();
            } catch (error) {
              console.error("Error al eliminar listado:", error);
              alert(error.message);
            }
          }
        });
      });
    }
  } catch (error) {
    console.error("Error al cargar listados:", error);
    loadingMessage.classList.add("hidden");
    errorMessage.classList.remove("hidden");
    errorMessage.textContent = `${t2("error")} ${error.message}`;
  }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmFzdHJvIl0sInNvdXJjZXNDb250ZW50IjpbIi0tLVxuaW1wb3J0IE1haW5MYXlvdXQgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9sYXlvdXQvTWFpbkxheW91dC5hc3Rybyc7XG5pbXBvcnQgeyBnZXRDdXJyZW50TGFuZ3VhZ2UsIHQgfSBmcm9tICcuLi8uLi9pMThuL2NvbmZpZyc7XG5cbi8vIE9idGVuZXIgZWwgaWRpb21hIGFjdHVhbFxuY29uc3QgY3VycmVudExhbmcgPSBnZXRDdXJyZW50TGFuZ3VhZ2UoKTtcblxuLy8gVHJhZHVjY2lvbmVzXG5jb25zdCB0cmFuc2xhdGlvbnMgPSB7XG4gIGVzOiB7XG4gICAgdGl0bGU6IFwiTGlzdGFkb3MgUGVyc29uYWxpemFkb3NcIixcbiAgICBkZXNjcmlwdGlvbjogXCJDcmVhIHkgZ2VzdGlvbmEgbGlzdGFkb3MgcGVyc29uYWxpemFkb3MgZGUgYW5pbWFsZXMgcGFyYSB2YWN1bmFjacOzbiB5IG90cm9zIHByb3DDs3NpdG9zLlwiLFxuICAgIGVtcHR5OiBcIk5vIGhheSBsaXN0YWRvcyBwZXJzb25hbGl6YWRvcyBkaXNwb25pYmxlcy5cIixcbiAgICBjcmVhdGU6IFwiQ3JlYXIgTnVldm8gTGlzdGFkb1wiLFxuICAgIGxvYWRpbmc6IFwiQ2FyZ2FuZG8gbGlzdGFkb3MuLi5cIixcbiAgICBlcnJvcjogXCJFcnJvciBhbCBjYXJnYXIgbG9zIGxpc3RhZG9zLlwiLFxuICAgIGNhdGVnb3J5OiBcIkNhdGVnb3LDrWFcIixcbiAgICBhbmltYWxzOiBcIkFuaW1hbGVzXCIsXG4gICAgYWN0aW9uczogXCJBY2Npb25lc1wiLFxuICAgIHZpZXc6IFwiVmVyXCIsXG4gICAgZWRpdDogXCJFZGl0YXJcIixcbiAgICBkZWxldGU6IFwiRWxpbWluYXJcIixcbiAgICBjb25maXJtRGVsZXRlOiBcIsK/RXN0w6FzIHNlZ3VybyBkZSBxdWUgcXVpZXJlcyBlbGltaW5hciBlc3RlIGxpc3RhZG8/XCIsXG4gICAgXCJleHBvcnRcIjogXCJFeHBvcnRhclwiLFxuICAgIHRhYmxlOiB7XG4gICAgICBuYW1lOiBcIk5vbWJyZVwiLFxuICAgICAgY2F0ZWdvcnk6IFwiQ2F0ZWdvcsOtYVwiLFxuICAgICAgYW5pbWFsczogXCJBbmltYWxlc1wiLFxuICAgICAgY3JlYXRlZEF0OiBcIkNyZWFkbyBlbFwiLFxuICAgICAgYWN0aW9uczogXCJBY2Npb25lc1wiXG4gICAgfVxuICB9LFxuICBjYToge1xuICAgIHRpdGxlOiBcIkxsaXN0YXRzIFBlcnNvbmFsaXR6YXRzXCIsXG4gICAgZGVzY3JpcHRpb246IFwiQ3JlYSBpIGdlc3Rpb25hIGxsaXN0YXRzIHBlcnNvbmFsaXR6YXRzIGQnYW5pbWFscyBwZXIgYSB2YWN1bmFjacOzIGkgYWx0cmVzIHByb3DDsnNpdHMuXCIsXG4gICAgZW1wdHk6IFwiTm8gaGkgaGEgbGxpc3RhdHMgcGVyc29uYWxpdHphdHMgZGlzcG9uaWJsZXMuXCIsXG4gICAgY3JlYXRlOiBcIkNyZWFyIE5vdSBMbGlzdGF0XCIsXG4gICAgbG9hZGluZzogXCJDYXJyZWdhbnQgbGxpc3RhdHMuLi5cIixcbiAgICBlcnJvcjogXCJFcnJvciBhbCBjYXJyZWdhciBlbHMgbGxpc3RhdHMuXCIsXG4gICAgY2F0ZWdvcnk6IFwiQ2F0ZWdvcmlhXCIsXG4gICAgYW5pbWFsczogXCJBbmltYWxzXCIsXG4gICAgYWN0aW9uczogXCJBY2Npb25zXCIsXG4gICAgdmlldzogXCJWZXVyZVwiLFxuICAgIGVkaXQ6IFwiRWRpdGFyXCIsXG4gICAgZGVsZXRlOiBcIkVsaW1pbmFyXCIsXG4gICAgY29uZmlybURlbGV0ZTogXCJFc3TDoHMgc2VndXIgcXVlIHZvbHMgZWxpbWluYXIgYXF1ZXN0IGxsaXN0YXQ/XCIsXG4gICAgXCJleHBvcnRcIjogXCJFeHBvcnRhclwiLFxuICAgIHRhYmxlOiB7XG4gICAgICBuYW1lOiBcIk5vbVwiLFxuICAgICAgY2F0ZWdvcnk6IFwiQ2F0ZWdvcmlhXCIsXG4gICAgICBhbmltYWxzOiBcIkFuaW1hbHNcIixcbiAgICAgIGNyZWF0ZWRBdDogXCJDcmVhdCBlbFwiLFxuICAgICAgYWN0aW9uczogXCJBY2Npb25zXCJcbiAgICB9XG4gIH1cbn07XG5cbi8vIEZ1bmNpw7NuIHBhcmEgdHJhZHVjaXIgKHNpbXBsaWZpY2FkYSlcbmZ1bmN0aW9uIHQoa2V5KSB7XG4gIHJldHVybiB0cmFuc2xhdGlvbnNbY3VycmVudExhbmddW2tleV0gfHwga2V5O1xufVxuXG4vLyBGdW5jacOzbiBwYXJhIHRyYWR1Y2lyIGNsYXZlcyBhbmlkYWRhcyAoc2ltcGxpZmljYWRhKVxuZnVuY3Rpb24gdE5lc3RlZChwYXJlbnQsIGtleSkge1xuICBpZiAodHJhbnNsYXRpb25zW2N1cnJlbnRMYW5nXSAmJiB0cmFuc2xhdGlvbnNbY3VycmVudExhbmddW3BhcmVudF0gJiYgdHJhbnNsYXRpb25zW2N1cnJlbnRMYW5nXVtwYXJlbnRdW2tleV0pIHtcbiAgICByZXR1cm4gdHJhbnNsYXRpb25zW2N1cnJlbnRMYW5nXVtwYXJlbnRdW2tleV07XG4gIH1cbiAgcmV0dXJuIGtleTtcbn1cbi0tLVxuXG48TWFpbkxheW91dCB0aXRsZT17dCgnbGlzdGluZ3MudGl0bGUnLCBjdXJyZW50TGFuZyl9PlxuICA8ZGl2IGNsYXNzPVwicHgtNCBweS0yIHNtOnB4LTYgbGc6cHgtOFwiPlxuICAgIDxkaXYgY2xhc3M9XCJzbTpmbGV4IHNtOml0ZW1zLWNlbnRlciBtYi0yXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwic206ZmxleC1hdXRvXCI+XG4gICAgICAgIDxoMSBjbGFzcz1cInRleHQteGwgZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC13aGl0ZVwiIGRhdGEtaTE4bi1rZXk9XCJsaXN0aW5ncy50aXRsZVwiPnt0KCdsaXN0aW5ncy50aXRsZScsIGN1cnJlbnRMYW5nKX08L2gxPlxuICAgICAgICA8cCBjbGFzcz1cIm10LTEgdGV4dC1zbSB0ZXh0LWdyYXktNzAwIGRhcms6dGV4dC1ncmF5LTMwMFwiIGRhdGEtaTE4bi1rZXk9XCJsaXN0aW5ncy5kZXNjcmlwdGlvblwiPlxuICAgICAgICAgIHt0KCdsaXN0aW5ncy5kZXNjcmlwdGlvbicsIGN1cnJlbnRMYW5nKX1cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwic206ZmxleC1ub25lXCI+XG4gICAgICAgIDxhIFxuICAgICAgICAgIGhyZWY9XCIvbGlzdGFkb3MvbnVldm9cIiBcbiAgICAgICAgICBjbGFzcz1cImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciByb3VuZGVkLW1kIGJvcmRlciBib3JkZXItdHJhbnNwYXJlbnQgYmctZ3JlZW4tNjAwIHB4LTQgcHktMiB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtd2hpdGUgc2hhZG93LXNtIGhvdmVyOmJnLWdyZWVuLTcwMCBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIGZvY3VzOnJpbmctZ3JlZW4tNTAwIGZvY3VzOnJpbmctb2Zmc2V0LTIgc206dy1hdXRvXCJcbiAgICAgICAgICBkYXRhLWkxOG4ta2V5PVwibGlzdGluZ3MuY3JlYXRlXCJcbiAgICAgICAgPlxuICAgICAgICAgIHt0KCdsaXN0aW5ncy5jcmVhdGUnLCBjdXJyZW50TGFuZyl9XG4gICAgICAgIDwvYT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cImJnLXdoaXRlIGRhcms6YmctZ3JheS04MDAgb3ZlcmZsb3ctaGlkZGVuIHNoYWRvdyByb3VuZGVkLWxnXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwib3ZlcmZsb3cteC1hdXRvXCI+XG4gICAgICAgIDxkaXYgaWQ9XCJsaXN0YWRvcy1jb250YWluZXJcIiBjbGFzcz1cIm1pbi1oLVs1MHB4XSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxwIGlkPVwibG9hZGluZy1tZXNzYWdlXCIgY2xhc3M9XCJ0ZXh0LWdyYXktNTAwXCIgZGF0YS1pMThuLWtleT1cImxpc3RpbmdzLmxvYWRpbmdcIj5cbiAgICAgICAgICAgIHt0KCdsaXN0aW5ncy5sb2FkaW5nJywgY3VycmVudExhbmcpfVxuICAgICAgICAgIDwvcD5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPCEtLSBQbGFudGlsbGEgcGFyYSBsYSB0YWJsYSAoc2UgbGxlbmEgY29uIEphdmFTY3JpcHQpIC0tPlxuICAgICAgICA8dGFibGUgaWQ9XCJsaXN0YWRvcy10YWJsZVwiIGNsYXNzPVwibWluLXctZnVsbCBkaXZpZGUteSBkaXZpZGUtZ3JheS0zMDAgaGlkZGVuXCI+XG4gICAgICAgICAgPHRoZWFkIGNsYXNzPVwiYmctZ3JheS01MCBkYXJrOmJnLWdyYXktNzAwXCI+XG4gICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiIGNsYXNzPVwicHgtMyBweS0zLjUgdGV4dC1sZWZ0IHRleHQtc20gZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMFwiIGRhdGEtaTE4bi1rZXk9XCJsaXN0aW5ncy50YWJsZS5uYW1lXCI+XG4gICAgICAgICAgICAgICAge3QoJ2xpc3RpbmdzLnRhYmxlLm5hbWUnLCBjdXJyZW50TGFuZyl9XG4gICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiIGNsYXNzPVwicHgtMyBweS0zLjUgdGV4dC1sZWZ0IHRleHQtc20gZm9udC1zZW1pYm9sZCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMFwiIGRhdGEtaTE4bi1rZXk9XCJsaXN0aW5ncy50YWJsZS5jYXRlZ29yeVwiPlxuICAgICAgICAgICAgICAgIHt0KCdsaXN0aW5ncy50YWJsZS5jYXRlZ29yeScsIGN1cnJlbnRMYW5nKX1cbiAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCIgY2xhc3M9XCJweC0zIHB5LTMuNSB0ZXh0LWxlZnQgdGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwXCIgZGF0YS1pMThuLWtleT1cImxpc3RpbmdzLnRhYmxlLmFuaW1hbHNcIj5cbiAgICAgICAgICAgICAgICB7dCgnbGlzdGluZ3MudGFibGUuYW5pbWFscycsIGN1cnJlbnRMYW5nKX1cbiAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgPHRoIHNjb3BlPVwiY29sXCIgY2xhc3M9XCJweC0zIHB5LTMuNSB0ZXh0LWxlZnQgdGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwXCIgZGF0YS1pMThuLWtleT1cImxpc3RpbmdzLnRhYmxlLmNyZWF0ZWRBdFwiPlxuICAgICAgICAgICAgICAgIHt0KCdsaXN0aW5ncy50YWJsZS5jcmVhdGVkQXQnLCBjdXJyZW50TGFuZyl9XG4gICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgIDx0aCBzY29wZT1cImNvbFwiIGNsYXNzPVwicmVsYXRpdmUgcHktMy41IHBsLTMgcHItNCBzbTpwci02XCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzci1vbmx5XCIgZGF0YS1pMThuLWtleT1cImxpc3RpbmdzLnRhYmxlLmFjdGlvbnNcIj57dCgnbGlzdGluZ3MudGFibGUuYWN0aW9ucycsIGN1cnJlbnRMYW5nKX08L3NwYW4+XG4gICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgPHRib2R5IGlkPVwibGlzdGFkb3MtYm9keVwiIGNsYXNzPVwiZGl2aWRlLXkgZGl2aWRlLWdyYXktMjAwIGRhcms6ZGl2aWRlLWdyYXktNjAwIGJnLXdoaXRlIGRhcms6YmctZ3JheS04MDBcIj5cbiAgICAgICAgICAgIDwhLS0gU2UgbGxlbmFyw6EgY29uIEphdmFTY3JpcHQgLS0+XG4gICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgPC90YWJsZT5cblxuICAgICAgICA8IS0tIE1lbnNhamUgZGUgZXJyb3IgKG9jdWx0byBwb3IgZGVmZWN0bykgLS0+XG4gICAgICAgIDxkaXYgaWQ9XCJlcnJvci1tZXNzYWdlXCIgY2xhc3M9XCJwLTQgdGV4dC1jZW50ZXIgdGV4dC1yZWQtNjAwIGhpZGRlblwiPlxuICAgICAgICAgIHt0KCdlcnJvcicpfVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8IS0tIE1lbnNhamUgZGUgdmFjw61vIChvY3VsdG8gcG9yIGRlZmVjdG8pIC0tPlxuICAgICAgICA8ZGl2IGlkPVwiZW1wdHktbWVzc2FnZVwiIGNsYXNzPVwicC04IHRleHQtY2VudGVyIHRleHQtZ3JheS01MDAgZGFyazp0ZXh0LWdyYXktNDAwIGhpZGRlblwiPlxuICAgICAgICAgIDxzdmcgY2xhc3M9XCJteC1hdXRvIGgtMTIgdy0xMiB0ZXh0LWdyYXktNDAwXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgICA8cGF0aCBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBzdHJva2Utd2lkdGg9XCIyXCIgZD1cIk05IDEzaDZtLTMtM3Y2bS05IDFWN2EyIDIgMCAwMTItMmg2bDIgMmg2YTIgMiAwIDAxMiAydjhhMiAyIDAgMDEtMiAySDVhMiAyIDAgMDEtMi0yelwiIC8+XG4gICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgPGgzIGNsYXNzPVwibXQtMiB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwXCI+e3QoJ2VtcHR5Jyl9PC9oMz5cbiAgICAgICAgICA8cCBjbGFzcz1cIm10LTEgdGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAge3QoJ2Rlc2NyaXB0aW9uJyl9XG4gICAgICAgICAgPC9wPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtdC02XCI+XG4gICAgICAgICAgICA8YVxuICAgICAgICAgICAgICBocmVmPVwiL2xpc3RhZG9zL251ZXZvXCJcbiAgICAgICAgICAgICAgY2xhc3M9XCJpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgcHgtNCBweS0yIGJvcmRlciBib3JkZXItdHJhbnNwYXJlbnQgc2hhZG93LXNtIHRleHQtc20gZm9udC1tZWRpdW0gcm91bmRlZC1tZCB0ZXh0LXdoaXRlIGJnLXByaW1hcnktNjAwIGhvdmVyOmJnLXByaW1hcnktNzAwIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgZm9jdXM6cmluZy1vZmZzZXQtMiBmb2N1czpyaW5nLXByaW1hcnktNTAwXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3QoJ2NyZWF0ZScpfVxuICAgICAgICAgICAgPC9hPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvTWFpbkxheW91dD5cblxuPHNjcmlwdD5cbiAgLy8gSW1wb3J0YXIgZWwgc2VydmljaW8gZGUgbGlzdGFkb3MgeSBzaXN0ZW1hIGRlIHRyYWR1Y2Npb25lc1xuICBpbXBvcnQgKiBhcyBsaXN0YWRvc1NlcnZpY2UgZnJvbSAnLi4vLi4vc2VydmljZXMvbGlzdGFkb3Mtc2VydmljZSc7XG4gIGltcG9ydCB7IGdldEN1cnJlbnRMYW5ndWFnZSwgdCB9IGZyb20gJy4uLy4uL2kxOG4vY29uZmlnJztcbiAgXG4gIC8vIEZ1bmNpw7NuIHBhcmEgYWN0dWFsaXphciB0b2RhcyBsYXMgdHJhZHVjY2lvbmVzIGVuIGxhIHDDoWdpbmFcbiAgZnVuY3Rpb24gdXBkYXRlQWxsVHJhbnNsYXRpb25zKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjdXJyZW50TGFuZyA9IGdldEN1cnJlbnRMYW5ndWFnZSgpO1xuICAgICAgY29uc29sZS5sb2coJ0xpc3RhZG9zOiBBY3R1YWxpemFuZG8gdHJhZHVjY2lvbmVzIGFsIGlkaW9tYTonLCBjdXJyZW50TGFuZyk7XG4gICAgICBcbiAgICAgIC8vIEFjdHVhbGl6YXIgdG9kb3MgbG9zIGVsZW1lbnRvcyBjb24gYXRyaWJ1dG8gZGF0YS1pMThuLWtleVxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaTE4bi1rZXldJykuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1pMThuLWtleScpO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgY29uc3QgdHJhbnNsYXRpb24gPSB0KGtleSwgY3VycmVudExhbmcpO1xuICAgICAgICAgIGlmICh0cmFuc2xhdGlvbiAhPT0ga2V5KSB7XG4gICAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IHRyYW5zbGF0aW9uO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRyYWR1Y2lkbyAnJHtrZXl9JyBhICcke3RyYW5zbGF0aW9ufSdgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBBY3R1YWxpemFyIHRhbWJpw6luIGVsIHTDrXR1bG8gZGUgbGEgcMOhZ2luYVxuICAgICAgY29uc3QgcGFnZVRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2UtdGl0bGUnKTtcbiAgICAgIGlmIChwYWdlVGl0bGUpIHtcbiAgICAgICAgcGFnZVRpdGxlLnRleHRDb250ZW50ID0gdCgnbGlzdGluZ3MudGl0bGUnLCBjdXJyZW50TGFuZyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFsIGFjdHVhbGl6YXIgdHJhZHVjY2lvbmVzOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICAvLyBFamVjdXRhciB0cmFkdWNjacOzbiBpbmljaWFsIHkgZXNjdWNoYXIgY2FtYmlvcyBkZSBpZGlvbWFcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgICAvLyBUcmFkdWNjacOzbiBpbmljaWFsXG4gICAgdXBkYXRlQWxsVHJhbnNsYXRpb25zKCk7XG4gICAgXG4gICAgLy8gRGV0ZWN0YXIgY2FtYmlvcyBkZSBpZGlvbWEgKGVzY3VjaGFyIGNhbWJpb3MgZW4gbG9jYWxTdG9yYWdlKVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUua2V5ID09PSAndXNlckxhbmd1YWdlJykge1xuICAgICAgICB1cGRhdGVBbGxUcmFuc2xhdGlvbnMoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG4gIFxuICAvLyBTY3JpcHQgcGFyYSBjYXJnYXIgbG9zIGxpc3RhZG9zIGRlc2RlIGxhIEFQSVxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGxpc3RhZG9zQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpc3RhZG9zLWNvbnRhaW5lcicpO1xuICAgIGNvbnN0IGxpc3RhZG9zVGFibGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlzdGFkb3MtdGFibGUnKTtcbiAgICBjb25zdCBsaXN0YWRvc0JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlzdGFkb3MtYm9keScpO1xuICAgIGNvbnN0IGxvYWRpbmdNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmctbWVzc2FnZScpO1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvci1tZXNzYWdlJyk7XG4gICAgY29uc3QgZW1wdHlNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VtcHR5LW1lc3NhZ2UnKTtcblxuICAgIC8vIFZlcmlmaWNhciBxdWUgZWwgdXN1YXJpbyBlc3TDqSBhdXRlbnRpY2Fkb1xuICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7XG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2xvZ2luJztcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBPYnRlbmVyIGVsIGlkaW9tYSBhY3R1YWxcbiAgICBjb25zdCBjdXJyZW50TGFuZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyTGFuZ3VhZ2UnKSB8fCAnZXMnO1xuICAgIFxuICAgIC8vIFRyYWR1Y2Npb25lcyBwYXJhIEphdmFTY3JpcHRcbiAgICBjb25zdCB0cmFuc2xhdGlvbnMgPSB7XG4gICAgICBlczoge1xuICAgICAgICB2aWV3OiBcIlZlclwiLFxuICAgICAgICBlZGl0OiBcIkVkaXRhclwiLFxuICAgICAgICBkZWxldGU6IFwiRWxpbWluYXJcIixcbiAgICAgICAgXCJleHBvcnRcIjogXCJFeHBvcnRhclwiLFxuICAgICAgICBjb25maXJtRGVsZXRlOiBcIsK/RXN0w6FzIHNlZ3VybyBkZSBxdWUgcXVpZXJlcyBlbGltaW5hciBlc3RlIGxpc3RhZG8/XCIsXG4gICAgICAgIGVycm9yOiBcIkVycm9yIGFsIGNhcmdhciBsb3MgbGlzdGFkb3MuXCIsXG4gICAgICAgIGRhdGVGb3JtYXQ6IHtcbiAgICAgICAgICBkYXk6IFwiMi1kaWdpdFwiLFxuICAgICAgICAgIG1vbnRoOiBcIjItZGlnaXRcIixcbiAgICAgICAgICB5ZWFyOiBcIm51bWVyaWNcIlxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2E6IHtcbiAgICAgICAgdmlldzogXCJWZXVyZVwiLFxuICAgICAgICBlZGl0OiBcIkVkaXRhclwiLFxuICAgICAgICBkZWxldGU6IFwiRWxpbWluYXJcIixcbiAgICAgICAgXCJleHBvcnRcIjogXCJFeHBvcnRhclwiLFxuICAgICAgICBjb25maXJtRGVsZXRlOiBcIkVzdMOgcyBzZWd1ciBxdWUgdm9scyBlbGltaW5hciBhcXVlc3QgbGxpc3RhdD9cIixcbiAgICAgICAgZXJyb3I6IFwiRXJyb3IgYWwgY2FycmVnYXIgZWxzIGxsaXN0YXRzLlwiLFxuICAgICAgICBkYXRlRm9ybWF0OiB7XG4gICAgICAgICAgZGF5OiBcIjItZGlnaXRcIixcbiAgICAgICAgICBtb250aDogXCIyLWRpZ2l0XCIsXG4gICAgICAgICAgeWVhcjogXCJudW1lcmljXCJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBGdW5jacOzbiBwYXJhIHRyYWR1Y2lyXG4gICAgY29uc3QgdCA9IChrZXkpID0+IHtcbiAgICAgIHJldHVybiB0cmFuc2xhdGlvbnNbY3VycmVudExhbmddPy5ba2V5XSB8fCBrZXk7XG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBDYXJnYXIgbG9zIGxpc3RhZG9zIHVzYW5kbyBudWVzdHJvIHNlcnZpY2lvIHNlZ3Vyb1xuICAgICAgY29uc3QgbGlzdGFkb3MgPSBhd2FpdCBsaXN0YWRvc1NlcnZpY2UuZ2V0TGlzdGFkb3MoKTtcblxuICAgICAgLy8gT2N1bHRhciBtZW5zYWplIGRlIGNhcmdhXG4gICAgICBsb2FkaW5nTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblxuICAgICAgaWYgKGxpc3RhZG9zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBNb3N0cmFyIG1lbnNhamUgZGUgdmFjw61vXG4gICAgICAgIGVtcHR5TWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1vc3RyYXIgdGFibGEgeSBsbGVuYXJsYSBjb24gZGF0b3NcbiAgICAgICAgbGlzdGFkb3NUYWJsZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblxuICAgICAgICAvLyBMaW1waWFyIGN1YWxxdWllciBjb250ZW5pZG8gcHJldmlvXG4gICAgICAgIGxpc3RhZG9zQm9keS5pbm5lckhUTUwgPSAnJztcblxuICAgICAgICAvLyBGb3JtYXRlYXIgZmVjaGFzIHNlZ8O6biBlbCBpZGlvbWFcbiAgICAgICAgY29uc3QgZGF0ZUZvcm1hdHRlciA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KFxuICAgICAgICAgIGN1cnJlbnRMYW5nID09PSAnY2EnID8gJ2NhLUVTJyA6ICdlcy1FUycsIFxuICAgICAgICAgIHQoJ2RhdGVGb3JtYXQnKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEHDsWFkaXIgY2FkYSBmaWxhIGEgbGEgdGFibGFcbiAgICAgICAgbGlzdGFkb3MuZm9yRWFjaChsaXN0YWRvID0+IHtcbiAgICAgICAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEZvcm1hdGVhciBmZWNoYVxuICAgICAgICAgIGNvbnN0IGNyZWF0ZWREYXRlID0gbmV3IERhdGUobGlzdGFkby5jcmVhdGVkX2F0KTtcbiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWREYXRlID0gZGF0ZUZvcm1hdHRlci5mb3JtYXQoY3JlYXRlZERhdGUpO1xuICAgICAgICAgIFxuICAgICAgICAgIHJvdy5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJ3aGl0ZXNwYWNlLW5vd3JhcCBweS00IHBsLTQgcHItMyB0ZXh0LXNtIGZvbnQtbWVkaXVtIHRleHQtZ3JheS05MDAgZGFyazp0ZXh0LWdyYXktMTAwIHNtOnBsLTZcIj5cbiAgICAgICAgICAgICAgJHtsaXN0YWRvLm5vbWJyZX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJ3aGl0ZXNwYWNlLW5vd3JhcCBweC0zIHB5LTQgdGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAgICAke2xpc3RhZG8uY2F0ZWdvcmlhIHx8ICctJ31cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJ3aGl0ZXNwYWNlLW5vd3JhcCBweC0zIHB5LTQgdGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAgICAke2xpc3RhZG8uYW5pbWFsZXNfY291bnQgfHwgMH1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJ3aGl0ZXNwYWNlLW5vd3JhcCBweC0zIHB5LTQgdGV4dC1zbSB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTQwMFwiPlxuICAgICAgICAgICAgICAke2Zvcm1hdHRlZERhdGV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwicmVsYXRpdmUgd2hpdGVzcGFjZS1ub3dyYXAgcHktNCBwbC0zIHByLTQgdGV4dC1yaWdodCB0ZXh0LXNtIGZvbnQtbWVkaXVtIHNtOnByLTZcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsZXgganVzdGlmeS1lbmQgc3BhY2UteC0yXCI+XG4gICAgICAgICAgICAgICAgPGEgaHJlZj1cIi9saXN0YWRvcy8ke2xpc3RhZG8uaWR9XCIgY2xhc3M9XCJpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgcHgtMiBweS0xIGJnLXByaW1hcnkgdGV4dC13aGl0ZSByb3VuZGVkIGhvdmVyOmJnLXByaW1hcnkvODBcIj5cbiAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiaC00IHctNCBtci0xXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS13aWR0aD1cIjJcIiBkPVwiTTE1IDEyYTMgMyAwIDExLTYgMCAzIDMgMCAwMTYgMHptLTEtOGExIDEgMCAwMC0xIDF2M2ExIDEgMCAwMDIgMFY2YTEgMSAwIDAwLTEtMXpcIj48L3BhdGg+XG4gICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS13aWR0aD1cIjJcIiBkPVwiTTIuNDU4IDEyQzMuNzMyIDcuOTQzIDcuNTIzIDUgMTIgNWM0LjQ3OCAwIDguMjY4IDIuOTQzIDkuNTQyIDctMS4yNzQgNC4wNTctNS4wNjQgNy05LjU0MiA3LTQuNDc3IDAtOC4yNjgtMi45NDMtOS41NDItN3pcIj48L3BhdGg+XG4gICAgICAgICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICAgICAgICR7dCgndmlldycpfVxuICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiL2xpc3RhZG9zL2VkaXRhci8ke2xpc3RhZG8uaWR9XCIgY2xhc3M9XCJpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgcHgtMiBweS0xIGJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcm91bmRlZCBob3ZlcjpiZy1ibHVlLTcwMFwiPlxuICAgICAgICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJoLTQgdy00IG1yLTFcIiBmaWxsPVwibm9uZVwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIj5cbiAgICAgICAgICAgICAgICAgICAgPHBhdGggc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIGQ9XCJNMTEgNUg2YTIgMiAwIDAwLTIgMnYxMWEyIDIgMCAwMDIgMmgxMWEyIDIgMCAwMDItMnYtNW0tMS40MTQtOS40MTRhMiAyIDAgMTEyLjgyOCAyLjgyOEwxMS44MjggMTVIOXYtMi44MjhsOC41ODYtOC41ODZ6XCI+PC9wYXRoPlxuICAgICAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgICAgICAke3QoJ2VkaXQnKX1cbiAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgICAgICAgIGRhdGEtbGlzdGFkby1pZD1cIiR7bGlzdGFkby5pZH1cIiBcbiAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZGVsZXRlLWJ1dHRvbiBpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgcHgtMiBweS0xIGJnLXJlZC02MDAgdGV4dC13aGl0ZSByb3VuZGVkIGhvdmVyOmJnLXJlZC03MDBcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiaC00IHctNCBtci0xXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS13aWR0aD1cIjJcIiBkPVwiTTE5IDdsLS44NjcgMTIuMTQyQTIgMiAwIDAxMTYuMTM4IDIxSDcuODYyYTIgMiAwIDAxLTEuOTk1LTEuODU4TDUgN201IDR2Nm00LTZ2Nm0xLTEwVjRhMSAxIDAgMDAtMS0xaC00YTEgMSAwIDAwLTEgMXYzTTQgN2gxNlwiPjwvcGF0aD5cbiAgICAgICAgICAgICAgICAgIDwvc3ZnPlxuICAgICAgICAgICAgICAgICAgJHt0KCdkZWxldGUnKX1cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8IS0tIEVubGFjZSBkZSBleHBvcnRhciBlbGltaW5hZG8gLS0+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICBgO1xuICAgICAgICAgIFxuICAgICAgICAgIGxpc3RhZG9zQm9keS5hcHBlbmRDaGlsZChyb3cpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBw7FhZGlyIGxpc3RlbmVycyBwYXJhIGJvdG9uZXMgZGUgZWxpbWluYXJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRlbGV0ZS1idXR0b24nKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RhZG9JZCA9IGUudGFyZ2V0LmRhdGFzZXQubGlzdGFkb0lkO1xuICAgICAgICAgICAgaWYgKGNvbmZpcm0odCgnY29uZmlybURlbGV0ZScpKSkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIEVsaW1pbmFyIGVsIGxpc3RhZG8gdXNhbmRvIGVsIHNlcnZpY2lvXG4gICAgICAgICAgICAgICAgYXdhaXQgbGlzdGFkb3NTZXJ2aWNlLmRlbGV0ZUxpc3RhZG8obGlzdGFkb0lkKTtcblxuICAgICAgICAgICAgICAgIC8vIFJlY2FyZ2FyIGxhIHDDoWdpbmEgcGFyYSBtb3N0cmFyIGxhIGxpc3RhIGFjdHVhbGl6YWRhXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFsIGVsaW1pbmFyIGxpc3RhZG86JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIGFsZXJ0KGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhbCBjYXJnYXIgbGlzdGFkb3M6JywgZXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBPY3VsdGFyIG1lbnNhamUgZGUgY2FyZ2FcbiAgICAgIGxvYWRpbmdNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgICAgXG4gICAgICAvLyBNb3N0cmFyIG1lbnNhamUgZGUgZXJyb3JcbiAgICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IGAke3QoJ2Vycm9yJyl9ICR7ZXJyb3IubWVzc2FnZX1gO1xuICAgIH1cbiAgfSk7XG48L3NjcmlwdD4iXSwibWFwcGluZ3MiOiJBQTJKRSxZQUFZLHFCQUFxQjtBQUNqQyxTQUFTLG9CQUFvQixTQUFTO0FBR3RDLFNBQVMsd0JBQXdCO0FBQy9CLE1BQUk7QUFDRixVQUFNLGNBQWMsbUJBQW1CO0FBQ3ZDLFlBQVEsSUFBSSxrREFBa0QsV0FBVztBQUd6RSxhQUFTLGlCQUFpQixpQkFBaUIsRUFBRSxRQUFRLFFBQU07QUFDekQsWUFBTSxNQUFNLEdBQUcsYUFBYSxlQUFlO0FBQzNDLFVBQUksS0FBSztBQUNQLGNBQU0sY0FBYyxFQUFFLEtBQUssV0FBVztBQUN0QyxZQUFJLGdCQUFnQixLQUFLO0FBQ3ZCLGFBQUcsY0FBYztBQUNqQixrQkFBUSxJQUFJLGNBQWMsR0FBRyxRQUFRLFdBQVcsR0FBRztRQUNyRDtNQUNGO0lBQ0YsQ0FBQztBQUdELFVBQU0sWUFBWSxTQUFTLGVBQWUsWUFBWTtBQUN0RCxRQUFJLFdBQVc7QUFDYixnQkFBVSxjQUFjLEVBQUUsa0JBQWtCLFdBQVc7SUFDekQ7RUFDRixTQUFTLE9BQU87QUFDZCxZQUFRLE1BQU0scUNBQXFDLEtBQUs7RUFDMUQ7QUFDRjtBQUdBLFNBQVMsaUJBQWlCLG9CQUFvQixNQUFNO0FBRWxELHdCQUFzQjtBQUd0QixTQUFPLGlCQUFpQixXQUFXLFNBQVMsR0FBRztBQUM3QyxRQUFJLEVBQUUsUUFBUSxnQkFBZ0I7QUFDNUIsNEJBQXNCO0lBQ3hCO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFHRCxTQUFTLGlCQUFpQixvQkFB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