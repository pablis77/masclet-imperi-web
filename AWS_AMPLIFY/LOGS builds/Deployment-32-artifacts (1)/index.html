<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Aplicaci√≥n de Gesti√≥n Ganadera Masclet Imperi">
  <title>Masclet Imperi</title>
  <!-- Favicon -->
  <link rel="shortcut icon" href="/favico.ico" type="image/x-icon">
  <!-- CSS Cr√≠tico -->
  
  
  
  <!-- CSS por secci√≥n -->
  <!-- MARCADOR: CSS SECCIONES -->
<link rel="stylesheet" href="/_astro/index.DJoSdzOi.css">
  <link rel="stylesheet" href="/_astro/vendor.DJv9yYup.css">
  <link rel="stylesheet" href="/_astro/_id_.CtbIiy9S.css">
</head>
<body>
  <div id="app">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">Cargando aplicaci√≥n...</p>
      <noscript>
        <p class="error-message">Esta aplicaci√≥n requiere JavaScript para funcionar. Por favor, habil√≠talo en tu navegador.</p>
      </noscript>
    </div>
  </div>
  
  <!-- Scripts cr√≠ticos -->
  <script src="/_astro/apiConfig.BYL0hBvc.js" type="module"></script>
  <script src="/_astro/apiConfigAdapter.B0N4Zv2p.js" type="module"></script>
  <script src="/_astro/apiService.DCRZ96ES.js" type="module"></script>
  <script src="/_astro/authService.CvC7CJU-.js" type="module"></script>
  <script src="/_astro/client.DKNAXmG2.js" type="module"></script>
  <script src="/_astro/config.DUTcyYPh.js" type="module"></script>
  <script src="/_astro/hoisted.1V3GKfbn.js" type="module"></script>
  <script src="/_astro/hoisted.BIqjo7BV.js" type="module"></script>
  <script src="/_astro/hoisted.a0A2-I9N.js" type="module"></script>
  <script src="/_astro/notificationService.DETo-XEc.js" type="module"></script>
  <script src="/_astro/vendor.BAk4NxX6.js" type="module"></script>
  
  <!-- Scripts por secci√≥n (carga din√°mica) -->
  <script>
  // Assets organizados por secci√≥n
  const SECTION_ASSETS = {
  "core": {
    "js": [
      "apiConfig.BYL0hBvc.js",
      "apiConfigAdapter.B0N4Zv2p.js",
      "apiService.DCRZ96ES.js",
      "authService.CvC7CJU-.js",
      "client.DKNAXmG2.js",
      "config.DUTcyYPh.js",
      "hoisted.1V3GKfbn.js",
      "hoisted.BIqjo7BV.js",
      "hoisted.a0A2-I9N.js",
      "notificationService.DETo-XEc.js",
      "vendor.BAk4NxX6.js"
    ],
    "css": [
      "index.DJoSdzOi.css"
    ]
  },
  "other": {
    "js": [],
    "css": []
  },
  "LOGIN": {
    "js": [
      "AuthMiddleware.CgZXvxDX.js",
      "ClearLocalStorage.i7bUfcoq.js",
      "LoginDebugger.DewzcQPo.js",
      "PasswordErrorModal.BrSl3daN.js",
      "RoleGuard.tKckocPJ.js",
      "PasswordErrorModal.BrSl3daN.js",
      "RoleGuard.tKckocPJ.js",
      "ClearLocalStorage.i7bUfcoq.js"
    ],
    "css": []
  },
  "DASHBOARD": {
    "js": [
      "Dashboard2.CHYKY2KF.js",
      "DashboardNew.CHYKY2KF.js",
      "DashboardV2.D3-bt97t.js",
      "NotificationsMenu._4m-Nx7C.js",
      "DashboardV2.D3-bt97t.js",
      "Dashboard2.CHYKY2KF.js",
      "DashboardNew.CHYKY2KF.js",
      "NotificationsMenu._4m-Nx7C.js"
    ],
    "css": []
  },
  "EXPLOTACIONES": {
    "js": [
      "ExplotacionesPage.B9QRgxsO.js",
      "ExplotacionesPage.B9QRgxsO.js"
    ],
    "css": []
  },
  "ANIMALES": {
    "js": [
      "AnimalFilters.BavX2u2F.js",
      "AnimalTable.DwggHQYQ.js",
      "animalService.Dx4yrBkr.js",
      "AnimalFilters.BavX2u2F.js",
      "AnimalTable.DwggHQYQ.js",
      "animalService.Dx4yrBkr.js"
    ],
    "css": []
  },
  "LISTADOS": {
    "js": [
      "listados-service.C0iTSrMs.js",
      "listados-service.C0iTSrMs.js"
    ],
    "css": []
  },
  "USUARIOS": {
    "js": [
      "UsersManagement.BG60y4Gz.js",
      "UsersManagement.BG60y4Gz.js",
      "RoleGuard.tKckocPJ.js"
    ],
    "css": []
  },
  "IMPORTACIONES": {
    "js": [
      "ImportContainer.C-yjQJUV.js",
      "ResetDatabaseButton.D6oeMAPH.js",
      "ResetDatabaseButton.D6oeMAPH.js",
      "ImportContainer.C-yjQJUV.js"
    ],
    "css": []
  },
  "BACKUP": {
    "js": [
      "LanguageSwitcher.astro_astro_type_script_index_0_lang.BhT4Hx0d.js",
      "LanguageSwitcher.astro_astro_type_script_index_0_lang.BhT4Hx0d.js",
      "NotificationsMenu._4m-Nx7C.js"
    ],
    "css": []
  },
  "NOTIFICACIONES": {
    "js": [
      "NotificationsMenu._4m-Nx7C.js",
      "notificationService.DETo-XEc.js"
    ],
    "css": []
  },
  "PERFIL": {
    "js": [
      "ProfileManagement.4Mpz4qBu.js",
      "ProfileManagement.4Mpz4qBu.js"
    ],
    "css": []
  },
  "AJUSTES": {
    "js": [
      "LanguageSwitcher.astro_astro_type_script_index_0_lang.BhT4Hx0d.js"
    ],
    "css": []
  }
};
  
  // Ruta base para los assets
  const BASE_PATH = '_astro';
  
  // Funci√≥n para cargar un script din√°micamente
  function loadScript(src) {
    return new Promise((resolve, reject) => {
      const script = document.createElement('script');
      script.src = src;
      script.type = 'module';
      script.onload = resolve;
      script.onerror = reject;
      document.body.appendChild(script);
    });
  }
  
  // Funci√≥n para cargar un CSS din√°micamente
  function loadCSS(href) {
    return new Promise((resolve) => {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = href;
      link.onload = resolve;
      document.head.appendChild(link);
    });
  }
  
  // Funci√≥n para cargar assets de una secci√≥n espec√≠fica
  async function loadSectionAssets(sectionName) {
    if (!SECTION_ASSETS[sectionName]) {
      console.warn('‚ö†Ô∏è Secci√≥n no encontrada:', sectionName);
      return;
    }
    
    const section = SECTION_ASSETS[sectionName];
    
    // Cargar CSS
    if (section.css && section.css.length > 0) {
      for (const cssFile of section.css) {
        // Evitar a√±adir dos veces _astro/
        let cleanCssFile = cssFile.replace(/^_astro\//, '');
        let cssPath = BASE_PATH ? '/' + BASE_PATH + '/' + cleanCssFile : '/' + cleanCssFile;
        // Eliminar dobles barras
        cssPath = cssPath.replace(new RegExp('//','g'), '/');
        await loadCSS(cssPath);
        console.log('‚úÖ CSS cargado:', cssFile);
      }
    }
    
    // Cargar JS
    if (section.js && section.js.length > 0) {
      for (const jsFile of section.js) {
        // Evitar a√±adir dos veces _astro/
        let cleanJsFile = jsFile.replace(/^_astro\//, '');
        let jsPath = BASE_PATH ? '/' + BASE_PATH + '/' + cleanJsFile : '/' + cleanJsFile;
        // Eliminar dobles barras
        jsPath = jsPath.replace(new RegExp('//','g'), '/');
        await loadScript(jsPath);
        console.log('‚úÖ Script cargado:', jsFile);
      }
    }
  }
  
  // Detectar secci√≥n actual basado en la ruta
  function detectCurrentSection() {
    const path = window.location.pathname;

    if (path.includes('/login')) {
      return 'LOGIN';
    } else if (path.includes('/explotacion')) {
      return 'EXPLOTACIONES';
    } else if (path.includes('/animal')) {
      return 'ANIMALES';
    } else if (path.includes('/listado')) {
      return 'LISTADOS';
    } else if (path.includes('/user')) {
      return 'USUARIOS';
    } else if (path.includes('/import')) {
      return 'IMPORTACIONES';
    } else if (path.includes('/backup')) {
      return 'BACKUP';
    } else {
      // Por defecto cargar dashboard
      return 'DASHBOARD';
    }
  }
  
  // Cargar assets de la secci√≥n actual
  document.addEventListener('DOMContentLoaded', async () => {
    try {
      const currentSection = detectCurrentSection();
      console.log('üîç Secci√≥n detectada:', currentSection);
      await loadSectionAssets(currentSection);
      console.log('‚úÖ Assets de la secci√≥n cargados correctamente');
    } catch (error) {
      console.error('‚ùå Error al cargar assets de secci√≥n:', error);
    }
  });
</script>
  
  <!-- Script de diagn√≥stico y carga -->
  <script>
    // Muestra mensajes de diagn√≥stico en caso de error
    window.addEventListener('error', function(e) {
      console.error('‚ö†Ô∏è Error en la carga:', e);
      const loadingText = document.querySelector('.loading-text');
      if (loadingText) {
        loadingText.innerHTML = 'Error al cargar la aplicaci√≥n<br><small>' + 
          e.message.substring(0, 100) + '...</small>';
        loadingText.style.color = '#ff3860';
      }
    });
    
    // Reporte de inicializaci√≥n correcta
    window.addEventListener('load', function() {
      console.log('‚úÖ Aplicaci√≥n cargada correctamente');
      
      // Ocultar el spinner cuando la aplicaci√≥n est√© cargada
      const loadingSpinner = document.querySelector('.loading-spinner');
      const loadingContainer = document.querySelector('.loading-container');
      
      if (loadingSpinner) {
        loadingSpinner.style.display = 'none';
      }
      
      if (loadingContainer) {
        // Esperar un poco para mostrar una transici√≥n suave
        setTimeout(() => {
          loadingContainer.style.display = 'none';
        }, 300);
      }
    });
  </script>
</body>
</html>