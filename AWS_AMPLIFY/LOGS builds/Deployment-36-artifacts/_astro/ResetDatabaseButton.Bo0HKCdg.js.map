{"version":3,"file":"ResetDatabaseButton.Bo0HKCdg.js","sources":["../../../src/services/adminService.ts","../../../src/components/admin/ResetDatabaseButton.tsx"],"sourcesContent":["// Servicio para funciones administrativas\n\n/**\n * Servicio para operaciones administrativas avanzadas\n */\nconst adminService = {\n  /**\n   * Resetea la base de datos (solo desarrollo)\n   */\n  async resetDatabase(): Promise<{ success: boolean; message: string }> {\n    try {\n      // URL del backend\n      const BACKEND_URL = 'http://localhost:8000';\n      \n      // Token de desarrollo\n      const headers: HeadersInit = {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer test_token_for_development'\n      };\n      \n      // Llamar al endpoint de reinicio\n      const response = await fetch(`${BACKEND_URL}/api/v1/reset-database`, {\n        method: 'POST',\n        headers: headers\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        console.log('Base de datos reiniciada con √©xito:', data);\n        return {\n          success: true,\n          message: 'Base de datos reiniciada con √©xito'\n        };\n      }\n      \n      const errorText = await response.text();\n      console.error('Error al reiniciar la base de datos:', {\n        status: response.status,\n        statusText: response.statusText,\n        error: errorText\n      });\n      \n      return {\n        success: false,\n        message: `Error al reiniciar la base de datos: ${response.status} ${response.statusText}`\n      };\n    } catch (error: any) {\n      console.error('Error general al reiniciar la base de datos:', error);\n      return {\n        success: false,\n        message: error.message || 'Error desconocido al reiniciar la base de datos'\n      };\n    }\n  }\n};\n\nexport default adminService;\n","import React, { useState } from 'react';\nimport adminService from '../../services/adminService';\n\n/**\n * Bot√≥n para resetear la base de datos con confirmaci√≥n doble\n */\nconst ResetDatabaseButton: React.FC = () => {\n  // Estados\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const [showSecondConfirmation, setShowSecondConfirmation] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [result, setResult] = useState<{ success: boolean; message: string } | null>(null);\n\n  // Manejador para el primer nivel de confirmaci√≥n\n  const handleFirstConfirmClick = () => {\n    setShowConfirmation(true);\n    setResult(null);\n  };\n\n  // Manejador para el segundo nivel de confirmaci√≥n\n  const handleSecondConfirmClick = () => {\n    setShowSecondConfirmation(true);\n  };\n\n  // Manejador para cancelar la operaci√≥n\n  const handleCancelClick = () => {\n    setShowConfirmation(false);\n    setShowSecondConfirmation(false);\n  };\n\n  // Manejador para resetear la base de datos\n  const handleResetDatabase = async () => {\n    setLoading(true);\n    try {\n      const result = await adminService.resetDatabase();\n      setResult(result);\n      \n      // Si es exitoso, cerrar los di√°logos despu√©s de un tiempo\n      if (result.success) {\n        setTimeout(() => {\n          setShowConfirmation(false);\n          setShowSecondConfirmation(false);\n        }, 3000);\n        \n        // Disparar evento para notificar a otros componentes\n        const event = new CustomEvent('database-reset', { detail: result });\n        document.dispatchEvent(event);\n      }\n    } catch (error: any) {\n      setResult({\n        success: false,\n        message: error.message || 'Error desconocido al resetear la base de datos'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Renderizar el componente\n  return (\n    <div className=\"reset-database-container\">\n      {/* Bot√≥n principal */}\n      {!showConfirmation && (\n        <button\n          onClick={handleFirstConfirmClick}\n          className=\"flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors duration-200\"\n          title=\"Esta acci√≥n borrar√° TODOS los datos\"\n        >\n          <span className=\"mr-2\">üóëÔ∏è</span>\n          <span>Resetear Base de Datos</span>\n        </button>\n      )}\n\n      {/* Primera confirmaci√≥n */}\n      {showConfirmation && !showSecondConfirmation && (\n        <div className=\"confirmation-dialog bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\n          <h3 className=\"text-red-700 dark:text-red-300 font-medium mb-2\">¬øEst√°s seguro?</h3>\n          <p className=\"text-sm text-red-600 dark:text-red-200 mb-4\">\n            Esta acci√≥n eliminar√° TODOS los datos de la base de datos. Esta operaci√≥n no se puede deshacer.\n          </p>\n          <div className=\"flex space-x-2\">\n            <button\n              onClick={handleSecondConfirmClick}\n              className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-md transition-colors duration-200\"\n              disabled={loading}\n            >\n              S√≠, continuar\n            </button>\n            <button\n              onClick={handleCancelClick}\n              className=\"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-md transition-colors duration-200\"\n              disabled={loading}\n            >\n              Cancelar\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Segunda confirmaci√≥n */}\n      {showConfirmation && showSecondConfirmation && (\n        <div className=\"confirmation-dialog bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\n          <h3 className=\"text-red-700 dark:text-red-300 font-medium mb-2\">\n            ¬°√öLTIMA ADVERTENCIA!\n          </h3>\n          <p className=\"text-sm text-red-600 dark:text-red-200 mb-4\">\n            <strong>¬øEst√°s ABSOLUTAMENTE seguro?</strong> Todos los animales, partos y registros hist√≥ricos ser√°n eliminados permanentemente.\n          </p>\n          <div className=\"flex space-x-2\">\n            <button\n              onClick={handleResetDatabase}\n              className={`px-4 py-2 text-white font-medium rounded-md transition-colors duration-200 ${\n                loading \n                  ? 'bg-red-400 cursor-not-allowed' \n                  : 'bg-red-600 hover:bg-red-700'\n              }`}\n              disabled={loading}\n            >\n              {loading ? 'Procesando...' : 'S√≠, RESETEAR TODO'}\n            </button>\n            <button\n              onClick={handleCancelClick}\n              className=\"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-md transition-colors duration-200\"\n              disabled={loading}\n            >\n              Cancelar\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Mensaje de resultado */}\n      {result && (\n        <div className={`mt-3 p-3 rounded-md ${\n          result.success \n            ? 'bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800' \n            : 'bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800'\n        }`}>\n          <p className={`text-sm font-medium ${\n            result.success \n              ? 'text-green-700 dark:text-green-300' \n              : 'text-red-700 dark:text-red-300'\n          }`}>\n            {result.message}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ResetDatabaseButton;\n"],"names":["adminService","BACKEND_URL","headers","response","data","errorText","error","ResetDatabaseButton","showConfirmation","setShowConfirmation","useState","showSecondConfirmation","setShowSecondConfirmation","loading","setLoading","result","setResult","handleFirstConfirmClick","handleSecondConfirmClick","handleCancelClick","handleResetDatabase","event","jsxs","jsx"],"mappings":"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"}