import{r as s,a as e}from"./vendor.DPE1g--N.js";import{g as p}from"./roleService.DNcnaYzk.js";import{i as g}from"./authService.CvC7CJU-.js";const b=({allowedRoles:r,children:a,fallback:i=null,redirectToLogin:t=!0})=>{const[o,l]=s.useState(!1),[d,u]=s.useState(!1),[m,x]=s.useState(!0),[f,h]=s.useState("");return s.useEffect(()=>{l(!0)},[]),s.useEffect(()=>{if(!o)return;if(!g()&&t){console.log("Usuario no autenticado, redirigiendo a login"),window.location.href="/login";return}const n=p();console.log("Rol actual:",n),console.log("Roles permitidos:",r),h(n);const c=r.includes(n);console.log("¿Tiene acceso?",c),u(c),x(!1),!c&&t&&console.log(`Acceso denegado: se requiere uno de estos roles [${r.join(", ")}]`)},[o,r,t]),m||!o?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):d?e.jsx(e.Fragment,{children:a}):e.jsx(e.Fragment,{children:i||e.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 my-4 rounded shadow-md",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Acceso denegado"}),e.jsx("p",{children:"No tienes los permisos necesarios para acceder a esta página."}),e.jsxs("p",{className:"mt-2 text-sm",children:["Se requiere uno de estos roles: ",r.join(", ")]}),e.jsxs("p",{className:"mt-2 text-sm",children:["Tu rol actual: ",f]})]})]})})})};export{b as RoleGuard};
