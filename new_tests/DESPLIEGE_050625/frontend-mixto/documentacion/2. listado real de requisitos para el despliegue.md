Listado REAL - Requisitos para Despliegue Mixto Node Alpine + Nginx en AWS
 Estructura de Archivos Necesaria
1. Configuraci贸n Docker
docker-compose.yml - Orquestaci贸n de servicios
node.Dockerfile - Configuraci贸n del contenedor Node.js
nginx.Dockerfile - Configuraci贸n del contenedor Nginx
nginx.conf - Configuraci贸n detallada de Nginx
2. Scripts de Configuraci贸n API
docker-api-master.js - Coordinador principal de configuraci贸n
docker-api-detector.js - Detecci贸n del backend
docker-api-config.js - Generaci贸n de configuraci贸n
docker-api-injector.js - Inyecci贸n de configuraciones
docker-diagnose.js - Diagn贸stico de conectividad
3. Archivos de Aplicaci贸n
/client/ - Directorio con archivos compilados del frontend (SSG)
/server/ - Directorio con archivos del servidor Node.js (SSR)
entry.mjs - Punto de entrada principal del servidor (crucial)
package.json - Dependencias m铆nimas de la aplicaci贸n
4. Scripts de Despliegue
desplegar_frontend_mixto_aws.ps1 - Script de despliegue
 Requisitos T茅cnicos
En la instancia AWS
Docker y Docker Compose instalados
Al menos 2GB de espacio libre (m铆nimo 15% del disco disponible)
Puertos 80 (y opcionalmente 443) abiertos en el firewall
Clave SSH configurada para acceso remoto
En la red Docker
Red masclet-network creada previamente
Contenedores backend y base de datos funcionando
DNS interno de Docker funcionando correctamente
En la m谩quina de desarrollo
PowerShell 5.0 o superior
Credenciales SSH para la instancia AWS
Cliente SCP configurado (parte de OpenSSH)
 Pasos de Despliegue
Preparaci贸n
Limpiar im谩genes y contenedores antiguos
Verificar espacio en disco (m铆nimo 15% libre)
Comprobar que los contenedores de backend est谩n activos
Transferencia de Archivos
Transferir TODOS los archivos mencionados arriba
Verificar que la estructura de directorios sea correcta
Permisos ejecutables para scripts (chmod +x)
Construcci贸n
Construir im谩genes de Docker con cache desactivado
Verificar que la construcci贸n completa sin errores
Almacenar logs de construcci贸n para diagn贸stico
Ejecuci贸n
Iniciar contenedores con docker-compose up -d
Verificar estado con docker-compose ps
Revisar logs inmediatamente (docker logs)
Verificaci贸n
Comprobar conectividad entre contenedores
Probar endpoints de salud (health checks)
Verificar funcionamiento del frontend y API
 Problemas Comunes y Soluciones
Si el contenedor Node.js se reinicia
Revisar logs espec铆ficos: docker logs masclet-frontend-node
Verificar existencia de entry.mjs
Comprobar permisos de archivos
Si Nginx muestra error 502
Revisar si Node.js est谩 corriendo (no solo creado)
Verificar que Node.js est谩 escuchando en puerto 3000
Comprobar red Docker y resoluci贸n DNS
Si hay errores de espacio en disco
Ejecutar: docker system prune -af --volumes
Excepto: --filter "label!=masclet-db" --filter "label!=masclet-backend"
Considerar aumentar tama帽o del volumen en AWS
Si hay errores de conexi贸n a la API
Revisar logs del detector de API
Comprobar si el backend responde (curl masclet-backend:8000/api/v1/health)
Verificar configuraci贸n DNS en /etc/hosts dentro del contenedor
 Verificaci贸n Post-Despliegue
Endpoints a Verificar
Frontend principal: http:///
Health check Node.js: http:///health
Health check Nginx: http:///nginx-health
API a trav茅s del proxy: http:///api/v1/health
Logs a Revisar
Node.js: docker logs masclet-frontend-node
Nginx: docker logs masclet-frontend
Diagn贸stico: docker exec masclet-frontend-node cat /app/diagnostico.log